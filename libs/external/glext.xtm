;; lib-loading config
(if *impc:compiler:with-cache* (sys:load "libs/aot-cache/glext.xtm" 'quiet))
(sys:load-preload-check 'glext)
(define *xtmlib-glext-loaded* #t)

(impc:aot:suppress-aot-do
 (sys:load "libs/base/base.xtm"))
(impc:aot:insert-forms (sys:load "libs/base/base.xtm" 'quiet))

(impc:aot:insert-header "xtmglext")

;; set up the current dylib name and path (for AOT compilation)
(bind-dylib libglext
  (cond ((string=? (sys:platform) "Linux")
         "libGL.so")
        ((string=? (sys:platform) "OSX")
         "/System/Library/Frameworks/OpenGL.framework/OpenGL")
        ((string=? (sys:platform) "Windows")
         "glext.dll"))
  "xtmglext")

(impc:aot:import-ll "xtmglext")


(bind-lib libglext glActiveTexture [void,i32]*)
(bind-lib libglext glGetShaderiv [void,i32,i32,i32*]*)
(bind-lib libglext glGetShaderInfoLog [void,i32,i32,i32*,i8*]*)
(bind-lib libglext glGetProgramiv [void,i32,i32,i32*]*)
(bind-lib libglext glGetProgramInfoLog [void,i32,i32,i32*,i8*]*)
(bind-lib libglext glCreateShader [i32,i32]*)
(bind-lib libglext glCreateProgram [i32,]*)
(bind-lib libglext glShaderSource [void,i32,i32,i8**,i32*]*)
(bind-lib libglext glCompileShader [void,i32]*)
(bind-lib libglext glAttachShader [void,i32,i32]*)
(bind-lib libglext glLinkProgram [void,i32]*)
(bind-lib libglext glUseProgram [void,i32]*)
(bind-lib libglext glUniform1f [void,i32,float]*)
(bind-lib libglext glUniform1i [void,i32,i32]*)
(bind-lib libglext glUniform2f [void,i32,float,float]*)
(bind-lib libglext glUniform1fv [void,i32,i32,float*]*)
(bind-lib libglext glUniform2fv [void,i32,i32,float*]*)
(bind-lib libglext glUniform3f [void,i32,float,float,float]*)
(bind-lib libglext glUniform4f [void,i32,float,float,float,float]*)
(bind-lib libglext glUniform3fv [void,i32,i32,float*]*)
(bind-lib libglext glUniform4fv [void,i32,i32,float*]*)
(bind-lib libglext glGetUniformLocation [i32,i32,i8*]*)
(bind-lib libglext glGenBuffers [void,i32,i32*]*)
(bind-lib libglext glBindBuffer [void,i32,i32]*)
(bind-lib libglext glBufferData [void,i32,i64,i8*,i32]*)
(bind-lib libglext glGetAttribLocation [i32,i32,i8*]*)
(bind-lib libglext glBufferSubData [void,i32,i64,i64,i8*]*)
(bind-lib libglext glEnableVertexAttribArray [void,i32]*)
(bind-lib libglext glVertexAttribPointer [void,i32,i32,i32,i8,i32,i8*]*)
(bind-lib libglext glDisableVertexAttribArray [void,i32]*)
(bind-lib libglext glBindAttribLocation [void,i32,i32,i8*]*)
(bind-lib libglext glGetUniformBlockIndex [i32,i32,i8*]*)
(bind-lib libglext glUniformBlockBinding [void,i32,i32,i32]*)
(bind-lib libglext glBindBufferRange [void,i32,i32,i32,i64,i64]*)
(bind-lib libglext glUniformMatrix4fv [void,i32,i32,i8,float*]*)
(bind-lib libglext glUniformMatrix3fv [void,i32,i32,i8,float*]*)
(bind-lib libglext glGenFramebuffers [void,i32,i32*]*)
(bind-lib libglext glGenRenderbuffers [void,i32,i32*]*)
(bind-lib libglext glBindFramebuffer [void,i32,i32]*)
(bind-lib libglext glBindRenderbuffer [void,i32,i32]*)
(bind-lib libglext glRenderbufferStorage [void,i32,i32,i32,i32]*)
(bind-lib libglext glFramebufferRenderbuffer [void,i32,i32,i32,i32]*)
(bind-lib libglext glFramebufferTexture [void,i32,i32,i32,i32]*)
(bind-lib libglext glFramebufferTexture1D [void,i32,i32,i32,i32,i32]*)
(bind-lib libglext glFramebufferTexture2D [void,i32,i32,i32,i32,i32]*)
(bind-lib libglext glFramebufferTexture3D [void,i32,i32,i32,i32,i32,i32]*)
(bind-lib libglext glCheckFramebufferStatus [i32,i32]*)

(impc:aot:insert-footer "xtmglext")
(define *xtmlib-glext-loaded* #t)
